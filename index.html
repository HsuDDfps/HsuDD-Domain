<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <title>HsuDDfps</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="icon" href="https://fav.farm/🖥️" type="image/x-icon">
  <style>
    body {
      background-color: #111;
      color: #fff;
      font-family: "Arial", sans-serif;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      height: 100vh;
      margin: 0;
      text-align: center;
    }
    h1 {
      font-size: 2rem;
      margin: 0;
    }
    .timestamp {
      color: #888;
      font-size: 0.9rem;
      margin-top: 0.5rem;
    }
    .button {
      margin-top: 2rem;
      padding: 0.75rem 1.5rem;
      font-size: 1rem;
      color: #fff;
      background-color: #6dcff4;
      border: none;
      border-radius: 999px;
      cursor: pointer;
      text-decoration: none;
      transition: background-color 0.2s ease;
    }
    .button:hover {
      background-color: #4ebbdc;
    }
  </style>
</head>
<body>
  <h1>此網域為 HsuDDfps 所有</h1>
  <div class="timestamp" id="timestamp"></div>

  <a class="button" href="https://status.hsuddfps.com/" target="_blank">
    小徐麥塊伺服器連線狀態查詢
  </a>

  <script>
    function updateTimestamp() {
      const now = new Date();
      const yyyy = now.getFullYear();
      const mm = String(now.getMonth() + 1).padStart(2, '0');
      const dd = String(now.getDate()).padStart(2, '0');
      const hh = String(now.getHours()).padStart(2, '0');
      const min = String(now.getMinutes()).padStart(2, '0');
      const ss = String(now.getSeconds()).padStart(2, '0');
      document.getElementById('timestamp').textContent =
        `${yyyy}-${mm}-${dd} ${hh}:${min}:${ss}`;
    }

    // 初始呼叫一次，之後每秒更新
    updateTimestamp();
    setInterval(updateTimestamp, 1000);
  </script>
</body>
</html>
  <footer>狀態每 30 秒自動更新一次｜最後更新：<span id="last-update">尚未更新</span></footer>

  <script>
    const servers = [
      { id: "proxy", name: "託管分支連線埠 (Velocity)", host: "mc.hsuddfps.com" },
      { id: "lobby", name: "大廳伺服器 (Lobby)", host: "mc.hsuddfps.com:30065" },
      { id: "survival", name: "生存【1】服 (Survival)", host: "mc.hsuddfps.com:30066" },
      { id: "creative", name: "建造【1】服 (Creative)", host: "mc.hsuddfps.com:30067" }
    ];

    async function fetchStatus(server) {
      const el = document.getElementById(server.id);
      el.className = "server";
      el.innerHTML = `${server.name} 讀取中...`;

      try {
        const res = await fetch(`https://api.mcsrvstat.us/2/${server.host}`);
        const data = await res.json();

        if (!data.online) {
          el.innerHTML = `<strong>${server.name}</strong>: <span class="offline">🔴 離線</span>`;
          el.classList.add("offline");
        } else {
          const ping = data.debug?.ping || null;
          el.innerHTML = `
            <strong>${server.name}</strong>: <span class="online">🟢 在線 (${data.players.online} / ${data.players.max})</span>
            ${data.motd?.html ? `<div class="motd">${data.motd.html.join("<br>")}</div>` : ""}
            ${ping !== null ? `<div class="ping">延遲：約 ${ping} ms</div>` : ""}
          `;
        }
      } catch {
        el.innerHTML = `<strong>${server.name}</strong>: <span class="offline">❌ 查詢失敗</span>`;
        el.classList.add("offline");
      }
    }

    async function refresh() {
      const progress = document.getElementById("progress-bar");
      progress.style.width = "0%";
      progress.style.display = "block";
      setTimeout(() => { progress.style.width = "50%"; }, 100);

      await Promise.all(servers.map(fetchStatus));

      progress.style.width = "100%";
      setTimeout(() => {
        progress.style.display = "none";
        progress.style.width = "0%";
      }, 500);

      document.getElementById("last-update").textContent = new Date().toLocaleTimeString();
    }

    function copyIP() {
      navigator.clipboard.writeText("mc.hsuddfps.com").then(() => {
        alert("已複製 IP：mc.hsuddfps.com\n快去 Minecraft 加入吧！");
      });
    }

    function launchMinecraft() {
      const link = document.createElement('a');
      link.href = "minecraft://?addExternalServer=小徐伺服器|mc.hsuddfps.com:25565";
      link.style.display = 'none';
      document.body.appendChild(link);
      link.click();
      document.body.removeChild(link);

      setTimeout(() => {
        alert("如果沒有自動啟動 Minecraft，請確認你是使用官方啟動器，或使用下方按鈕複製 IP 手動加入。");
      }, 500);
    }

    refresh();
    setInterval(refresh, 30000);
  </script>
</body>
</html>
